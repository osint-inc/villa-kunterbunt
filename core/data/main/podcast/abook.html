<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Villa Kunterbunt | Das Korrespondenz Epos</title>
    <link rel="icon" type="image/png" href="../../../website/data/main/images/favicon.png">

    <!-- SEO / Social Media -->
    <meta property="og:title" content="Die Villa Kunterbunt | Das H√∂rbuch">
    <meta property="og:description"
        content="Erleben Sie die systemanalytische Aufarbeitung als zusammenh√§ngendes Audio-Erlebnis.">
    <meta property="og:image" content="../images/thumbs/die_villa_kunterbunt_abook_cover_front_thumb.png">
    <link rel="apple-touch-icon" href="../images/thumbs/die_villa_kunterbunt_abook_cover_front_thumb.png">
    <meta name="description"
        content="Die Villa Kunterbunt - Das H√∂rbuch. Die vollst√§ndige Korrespondenz und Systemanalyse als Audio-Dokumentation.">
    <!-- Google Fonts for premium typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0f1115;
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --accent-gold: #d4af37;
            /* Noble gold accent */
            --accent-gold-dim: #aa8c2c;
            --glass-bg: rgba(20, 20, 20, 0.75);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.03);
            --shadow-soft: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* Ambient Background */
        .ambient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('../../../website/data/main/images/wallpaper.png');
            background-size: cover;
            background-position: center;
            filter: blur(60px) brightness(0.25) saturate(1.2);
            z-index: -1;
            transform: scale(1.1);
        }

        .main-container {
            width: 100%;
            max-width: 800px;
            padding: 40px 20px;
            z-index: 1;
            box-sizing: border-box;
        }

        /* Header Section */
        header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            margin: 0;
            background: linear-gradient(to right, #fff, #e0e0e0);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            font-style: italic;
            color: var(--accent-gold);
            margin-top: 10px;
            letter-spacing: 1px;
        }

        /* Episode List */
        .episode-list {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        /* Episode Card */
        .episode-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 24px;
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 20px;
            animation: fadeInUp 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }

        .episode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-highlight), transparent);
        }

        .episode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px -15px rgba(0, 0, 0, 0.6);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .cover-flip-container {
            width: 200px;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
            margin: 0 auto;
        }

        .cover-flip-container .flipper {
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }

        .cover-flip-container.flipped .flipper {
            transform: rotateY(180deg);
        }

        .front,
        .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .front img,
        .back img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
        }

        .back {
            transform: rotateY(180deg);
        }

        .episode-tag {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--accent-gold);
            font-weight: 600;
        }

        .episode-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .badge {
            display: inline-block;
            padding: 2px 10px;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            border-radius: 4px;
            background: var(--accent-gold);
            color: var(--bg-dark);
            vertical-align: middle;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            font-family: 'Inter', sans-serif;
        }

        .episode-description {
            font-size: 1rem;
            color: var(--text-muted);
            line-height: 1.6;
            max-width: 600px;
        }

        .episode-description.collapsed {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .episode-description.expanded {
            display: block;
        }

        .read-more-btn {
            background: none;
            border: none;
            color: var(--accent-gold);
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 5px;
            padding: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .read-more-btn:hover {
            text-decoration: underline;
        }

        /* Player Controls */
        .player-controls {
            display: flex;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 500px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .play-btn {
            background: var(--text-main);
            color: var(--bg-dark);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        .play-btn:hover {
            background: var(--accent-gold);
            transform: scale(1.1);
        }

        .progress-wrapper {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
        }

        .progress-bar-bg {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-gold);
            width: 0%;
            border-radius: 3px;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            right: -4px;
            top: -3px;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .progress-bar-bg:hover .progress-fill::after {
            opacity: 1;
        }

        .time-display {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
            font-variant-numeric: tabular-nums;
        }

        .control-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            color: var(--text-main);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 0;
            width: 100%;
            justify-content: center;
            margin-top: 5px;
        }

        .volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: var(--text-muted);
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.2s;
        }

        .volume-slider:hover::-webkit-slider-thumb {
            background: var(--accent-gold);
        }

        /* Navigation Links */
        .nav-links {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--glass-border);
        }

        .nav-link {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            color: var(--text-muted);
            text-decoration: none;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .nav-link:hover {
            color: var(--text-main);
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .nav-link.highlight {
            border-color: rgba(212, 175, 55, 0.3);
            color: var(--accent-gold);
        }

        .nav-link.highlight:hover {
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.1);
            color: #fff;
        }

        footer {
            margin-top: 60px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.85rem;
            padding-bottom: 40px;
        }

        a {
            color: var(--text-main);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--accent-gold);
        }

        .action-link {
            display: inline-block;
            margin-top: 10px;
            padding: 8px 16px;
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            color: var(--accent-gold);
            font-size: 0.85rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .action-link:hover {
            background: rgba(212, 175, 55, 0.3);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
            transform: translateY(-1px);
            color: #fff;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Info & Source Buttons */
        .info-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .info-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: var(--text-muted);
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .info-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-main);
        }

        .info-btn.source-btn.no-source {
            background: rgba(220, 53, 69, 0.1);
            border-color: rgba(220, 53, 69, 0.3);
            color: #ff4d4d;
            cursor: default;
        }

        .info-btn.source-btn.has-source {
            background: rgba(40, 167, 69, 0.1);
            border-color: rgba(40, 167, 69, 0.3);
            color: #2ecc71;
        }

        .info-btn.source-btn.has-source:hover {
            background: rgba(40, 167, 69, 0.2);
            border-color: rgba(40, 167, 69, 0.5);
            color: #2ecc71;
        }

        @keyframes pulse-gold {
            0% {
                box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(212, 175, 55, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(212, 175, 55, 0);
            }
        }

        .pulse-gold {
            animation: pulse-gold 1.5s infinite;
            border-color: var(--accent-gold) !important;
            background: rgba(212, 175, 55, 0.1) !important;
        }

        .info-text {
            display: none;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            line-height: 1.5;
            color: var(--text-muted);
            margin-bottom: 20px;
            border-left: 3px solid var(--accent-gold);
            animation: fadeIn 0.3s ease;
            text-align: left !important;
        }

        .info-text.visible {
            display: block !important;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>

    <div class="ambient-bg"></div>

    <div class="main-container">
        <header>
            <h1>Die Villa Kunterbunt</h1>
            <div class="subtitle">Das H√∂rbuch</div>
            <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="../../cowork/podcast/index.html" class="action-link">üéß Die Anthologie</a>
                <a href="../../meta/podcast/index.html" class="action-link">üéôÔ∏è Das Kompendium</a>
            </div>
        </header>

        <article class="episode-card">
            <div class="cover-flip-container" onclick="this.classList.toggle('flipped')">
                <div class="flipper">
                    <div class="front">
                        <img src="../images/thumbs/die_villa_kunterbunt_abook_cover_front_thumb.png" alt="Front Cover">
                    </div>
                    <div class="back">
                        <img src="../images/thumbs/die_villa_kunterbunt_abook_cover_back_thumb.png" alt="Back Cover">
                    </div>
                </div>
            </div>

            <div class="episode-tag">Das H√∂rbuch</div>
            <h2 class="episode-title">Das H√∂rbuch <span class="badge">BETA</span></h2>

            <div class="info-bar">
                <button id="tts-btn" class="info-btn" onclick="toggleInfo()">TTS</button>
                <button class="info-btn source-btn has-source"
                    onclick="openSource('../documents/villa_kunterbunt_korrespondenz_epos_derlemue.pdf')">Quelle</button>
            </div>

            <div id="info-text" class="info-text">
                Die Audioinhalte wurden mittels <strong>Text-to-Speech-Synthese (TTS)</strong> generiert. Als
                Datengrundlage dienen
                <strong>strukturierte Markdown-Skripte</strong>, die aus Studien, Berichten und technischer
                Dokumentation extrahiert
                wurden. Die Skripterstellung erfolgt intern oder durch Dritte, wobei sowohl <strong>rein manuelle
                    Verfahren</strong> als auch <strong>hybride Prozesse</strong> unter Einsatz von
                <strong>Deep-Research-Modellen</strong> zur Anwendung kommen. S√§mtliche Quelldateien unterliegen einer
                <strong>abschlie√üenden manuellen
                    Qualit√§tspr√ºfung</strong>.
            </div>

            <div class="episode-description collapsed" id="desc-text">
                In dieser Episode tauchen wir tief in das ‚ÄûEpos der Villa Kunterbunt‚Äú ein ‚Äì ein Dokument, das weit √ºber
                eine gew√∂hnliche Kundenbeschwerde hinausgeht und sich als Manifest moderner Verbraucherfrustration
                versteht. Der Host analysiert die Korrespondenz rund um den ber√ºchtigten Phasenausfall L3 und
                dekonstruiert dabei die systemischen Vers√§umnisse gro√üer Versorgungsunternehmen. Es ist eine Reise durch
                ein ‚Äûprozessuales Paralleluniversum‚Äú, in dem administrative Blindheit auf technische Inkompetenz trifft.
                <br><br>
                Die Analyse beleuchtet, wie der betroffene Kunde durch einen radikalen Strategiewechsel ‚Äì weg vom
                ‚ÄûBittsteller‚Äú, hin zum ‚ÄûAnlieferer wertvoller Prozessdaten‚Äú ‚Äì die Spielregeln des Konzern-Dialogs
                √§ndert. Besonders im Fokus stehen die satirischen Spitzen gegen das ‚ÄûRemote-Voodoo‚Äú der Fernanalyse und
                die Kunst, f√ºr 15 Minuten wirkungslose Arbeit horrende Summen in Rechnung zu stellen. Die Episode
                arbeitet heraus, dass die Suche nach der ‚Äûdritten Phase‚Äú letztlich die Suche nach einer kompetenten
                Instanz ist, die Verantwortung in einem automatisierten System √ºbernimmt.
                <br><br>
                F√ºr Professionals aus den Bereichen Customer Experience (CX), Qualit√§tsmanagement und
                Business-Transformation bietet diese Folge eine brillante Fallstudie. Sie zeigt auf, wie Unternehmen
                durch Ignoranz ihre eigene Reputation demontieren und warum echte Fachkompetenz am ‚ÄûKabel‚Äú wertvoller
                ist als jede Management-Sitzung. Ein tiefgr√ºndiger, analytischer und zugleich unterhaltsamer Blick auf
                die Abgr√ºnde des modernen Dienstleistungswesens.
            </div>
            <button class="read-more-btn" id="read-more-btn" onclick="toggleDescription()">MEHR ANZEIGEN</button>

            <div class="player-controls" style="margin-top: 10px; gap: 15px;">
                <button class="control-btn" onclick="skip(-30)" title="-30s">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z" />
                    </svg>
                </button>

                <button class="play-btn" id="play-btn" aria-label="Play Episode">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>

                <button class="control-btn" onclick="skip(30)" title="+30s">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z" />
                    </svg>
                </button>

                <div class="progress-wrapper">
                    <div class="progress-bar-bg" id="progress-container">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="time-display">
                        <span id="current-time">0:00</span>
                        <span id="duration">0:00</span>
                    </div>
                </div>

                <div class="volume-control">
                    <input type="range" class="volume-slider" min="0" max="1" step="0.1" value="0.8"
                        oninput="setVolume(this.value)">
                </div>
            </div>
            <audio id="audio-player" src="../audio/die_villa_kunterbunt_das_hoerbuch.mp3" preload="metadata"></audio>

            <div class="nav-links"
                style="border-top: none; margin-top: 20px; padding-top: 0; display: flex; justify-content: center; flex-direction: column; gap: 15px;">
                <div style="display: flex; justify-content: center; gap: 20px;">
                    <button class="nav-link" disabled style="opacity: 0.5; cursor: not-allowed;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 12H5M12 19l-7-7 7-7" />
                        </svg>
                        <span>Vorherige Episode</span>
                    </button>
                    <div class="nav-link" disabled
                        style="opacity: 0.5; cursor: not-allowed; display: flex; align-items: center; gap: 8px;">
                        <span>N√§chste Episode</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
                <div style="display: flex; justify-content: center;">
                    <a href="index.html" class="nav-link highlight">
                        <span>Alle Episoden</span>
                    </a>
                </div>
            </div>
        </article>

        <footer>
            <a href="https://derlemue.github.io/villa-kunterbunt/"
                style="display:inline-flex; align-items:center; gap:8px; color:var(--text-muted); text-decoration:none; padding:10px 20px; border:1px solid var(--glass-border); border-radius:30px; transition:all 0.2s ease; background:rgba(255,255,255,0.05);">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                </svg>
                <span>Zum Projekt auf GitHub</span>
            </a>
        </footer>
    </div>

    <script>
        const audio = document.getElementById('audio-player');
        const playBtn = document.getElementById('play-btn');
        const progressContainer = document.getElementById('progress-container');
        const progressFill = document.getElementById('progress-fill');
        const currentTimeEl = document.getElementById('current-time');
        const durationEl = document.getElementById('duration');

        const playIcon = '<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>';
        const pauseIcon = '<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

        // Set initial volume
        audio.volume = 0.8;

        playBtn.addEventListener('click', togglePlay);

        function togglePlay() {
            if (audio.paused) {
                audio.play();
                playBtn.innerHTML = pauseIcon;
                triggerTTSHint();
            } else {
                audio.pause();
                playBtn.innerHTML = playIcon;
            }
        }

        function toggleDescription() {
            const desc = document.getElementById('desc-text');
            const btn = document.getElementById('read-more-btn');
            desc.classList.toggle('collapsed');
            desc.classList.toggle('expanded');

            if (desc.classList.contains('collapsed')) {
                btn.innerText = "MEHR ANZEIGEN";
            } else {
                btn.innerText = "WENIGER ANZEIGEN";
            }
        }

        // Onboarding / TTS Hint Logic
        let ttsTimeout;

        function toggleInfo() {
            const infoText = document.getElementById('info-text');

            if (ttsTimeout) clearTimeout(ttsTimeout);

            const isVisible = infoText.classList.toggle('visible');

            if (isVisible) {
                ttsTimeout = setTimeout(() => {
                    infoText.classList.remove('visible');
                }, 10000);
            }
        }

        // Onboarding / TTS Hint Logic
        function triggerTTSHint() {
            const hintKey = 'main_abook_tts_hint_shown';
            if (localStorage.getItem(hintKey)) return;

            const ttsBtn = document.getElementById('tts-btn');

            setTimeout(() => {
                toggleInfo(); // Auto-open with 10s timer

                // Visual cue (pulse) while open or after?
                // Kept simple: just pulse the button to draw attention
                ttsBtn.classList.add('pulse-gold');
                setTimeout(() => {
                    ttsBtn.classList.remove('pulse-gold');
                }, 3000);
            }, 500);

            localStorage.setItem(hintKey, 'true');
        }

        audio.addEventListener('timeupdate', () => {
            const progressPercent = (audio.currentTime / audio.duration) * 100;
            progressFill.style.width = `${progressPercent}%`;
            currentTimeEl.textContent = formatTime(audio.currentTime);
        });

        progressContainer.addEventListener('click', (e) => {
            const width = progressContainer.clientWidth;
            const clickX = e.offsetX;
            const duration = audio.duration;
            audio.currentTime = (clickX / width) * duration;
        });

        audio.addEventListener('loadedmetadata', () => {
            durationEl.textContent = formatTime(audio.duration);
        });

        audio.addEventListener('ended', () => {
            playBtn.innerHTML = playIcon;
            progressFill.style.width = '0%';
            currentTimeEl.textContent = '0:00';
        });

        function formatTime(seconds) {
            const min = Math.floor(seconds / 60);
            const sec = Math.floor(seconds % 60);
            return `${min}:${sec < 10 ? '0' : ''}${sec}`;
        }

        function skip(seconds) {
            audio.currentTime += seconds;
        }

        function setVolume(value) {
            audio.volume = value;
        }


        function openSource(url) {
            if (url) {
                window.open(url, '_blank');
            }
        }

        // MediaSession API
        if ('mediaSession' in navigator) {
            audio.addEventListener('play', () => {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: "Das H√∂rbuch",
                    artist: "Villa Kunterbunt",
                    album: "Das H√∂rbuch",
                    artwork: [
                        { src: new URL("../images/thumbs/die_villa_kunterbunt_abook_cover_front_thumb.png", window.location.href).href, sizes: '512x512', type: 'image/png' }
                    ]
                });

                navigator.mediaSession.setActionHandler('play', () => audio.play());
                navigator.mediaSession.setActionHandler('pause', () => audio.pause());
                navigator.mediaSession.setActionHandler('seekbackward', (details) => {
                    audio.currentTime = Math.max(audio.currentTime - (details.seekOffset || 10), 0);
                });
                navigator.mediaSession.setActionHandler('seekforward', (details) => {
                    audio.currentTime = Math.min(audio.currentTime + (details.seekOffset || 10), audio.duration);
                });
            });
        }

        // Persistence Logic
        const persistenceKey = 'vp_time_die_villa_kunterbunt_das_hoerbuch.mp3';
        const savedTime = localStorage.getItem(persistenceKey);
        if (savedTime) {
            audio.currentTime = parseFloat(savedTime);
        }
        audio.addEventListener('timeupdate', () => {
            localStorage.setItem(persistenceKey, audio.currentTime);
        });
    </script>
</body>

</html>